<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SSO Login</title>
    <!-- Latest compiled and minified CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
    />

    <!-- Latest compiled JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  </head>

  <style>
    .flash {
      display: none;
    }
  </style>

  <script>
    $(document).ready(function () {
      $("#btn-login").on("click", function () {
        const username = $("#username").val();
        const password = $("#password").val();

        $("#flashMsg").empty('');

        $.ajax({
          type: "POST",
          url: `${window.location.origin}/login`,
          data: { username, password },
          withCredentials: true,
          success: function (data) {
            $("#flashMsg").addClass("flash");
            window.location.href = '/'
          },
          error: function (request, status, error) {
            $("#password").val("");
            $("#flashMsg").removeClass("flash");
            $("#flashMsg").append(request.responseText);
          },
        });
      });
    });
  </script>

  <body>
    <div class="container">
      <div class="row">
        <form action="/login" method="POST">
          <div class="col-6 mx-auto my-auto">
            <fieldset class="border rounded-3 p-3">
              <legend class="float-none w-auto px-3">Đăng nhập</legend>

              <div
                class="alert alert-danger my-1 flash"
                role="alert"
                id="flashMsg"
              ></div>

              <div class="mb-3 col-12">
                <label for="exampleInputEmail1" class="form-label">Email</label>
                <input
                  type="email"
                  class="form-control"
                  id="username"
                  name="username"
                />
              </div>
              <div class="mb-3 col-12">
                <label for="exampleInputPassword1" class="form-label"
                  >Mật khẩu</label
                >
                <input
                  type="password"
                  class="form-control"
                  id="password"
                  name="password"
                />
              </div>
              <button type="button" id="btn-login" class="btn btn-primary">
                Đăng nhập
              </button>
              <hr />
              <div class="text-center">
                <span>Hoặc đăng nhập với: </span>
              </div>
              <div class="text-center mt-2">
                <i
                  style="font-size: 32px; cursor: pointer; margin-right: 12px"
                  class="bi bi-google"
                  title="Đăng nhập với Google"
                >
                </i>
                <i
                  style="font-size: 32px; cursor: pointer"
                  class="bi bi-facebook"
                  title="Đăng nhập với facebook"
                ></i>
              </div>
            </fieldset>
          </div>
        </form>
      </div>
    </div>
  </body>
</html>
